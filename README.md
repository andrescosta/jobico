# Jobico

## Introduction

Welcome to Jobico â€“ An Experimental, Multi-Tenancy Job Execution Platform!

Jobico is a project in the realm of experimental development with no commercial objectives. Specifically crafted for exploring job execution using WebAssembly (WASM) in a multi-tenancy environment, Jobico emphasizes flexibility and customization. It empowers tenants to define events, validate incoming data using JSON Schema, and execute custom programs written in any WASM-compatible language.

## Key Characteristics

- **Exploratory Nature**: Jobico is an exploratory project, offering a platform to delve into innovative approaches to job execution technologies.
- **Non-Commercial Objective**: Our primary goal is not commercial gain but rather fostering exploration and creativity in the realm of job execution and event processing.
- **Multi-Tenancy Focus**: Jobico is architected to support multi-tenancy, allowing for the simultaneous operation of multiple isolated tenants on the platform.
- **Event Definition with JSON Schema**: Tenants can define events by providing JSON Schema, enabling structured and dynamic event handling. Incoming requests are validated against the defined schema.
- **WASM-Compatible Language Support**: Tenants have the freedom to create custom programs in any WASM-compatible language, promoting flexibility and diversity in job execution.


# Architecture
![alt](docs/img/Jobico.svg?)

## Components

### Listener
The **Listener** component serves as the entry point for external events, providing a REST API that functions as a webhook. Its primary responsibilities include receiving events, validating them against pre-defined JSON schemas, and subsequently enqueueing them for further processing. This component acts as the bridge between external sources triggering events and the internal processing pipeline.

### Queue
The **Queue** component acts as a chronological buffer for events, temporarily storing them until they can be processed by the Job Executors. Events are maintained in the queue in the order they are received, ensuring a sequential flow of processing. This component plays a crucial role in decoupling the event reception from the actual event processing, allowing for scalability and efficient handling of bursts of incoming events.

### Job Executors
**Job Executors** are responsible for consuming events from the Queue and providing a controlled environment for the execution of WebAssembly (WASM) programs that process these events. This component manages the execution context, ensuring isolation and security for running custom WASM programs written by tenants. It plays a key role in the dynamic and scalable execution of programmed jobs in response to events.

### Control Service
The **Control Service** is a centralized hub where Job definitions are stored and can be queried by other components in the system. It acts as the authoritative source for managing job configurations, allowing dynamic adjustments to the processing logic without interrupting the overall system operation. This service facilitates coordination and control over the execution of jobs across the entire platform.

### Job Repository
The **Job Repository** serves as a storage facility for WebAssembly (WASM) programs and JSON schema files. It provides a dedicated API for storing and retrieving these essential files, ensuring accessibility for the Job Executors and enabling tenants to manage their custom program logic efficiently. This component acts as a repository for the building blocks required for event processing.

### Executions Recorder
The **Executions Recorder** is a service designed to capture and store log information generated by the Job Executors during the execution of jobs. This component acts as a centralized logging system, allowing for post-execution analysis, troubleshooting, and performance monitoring. The recorded information can be queried using both the Command Line Interface (CLI) and Dashboard tools, providing visibility into the historical execution details of jobs.

### Command Line Tool
The **Command Line Tool** serves as the primary management interface, providing a comprehensive set of commands for tenants to interact with the Jobico platform. This tool empowers tenants to deploy job definitions, upload associated WASM and JSON schema files, and query the Executions Recorder for log information. Its command-line interface offers flexibility and efficiency in managing and overseeing job-related activities within the system.

### Dashboard
The **Dashboard** is a terminal-based application designed for visualizing Job definitions and execution information. Sporting a colorful and intuitive interface, the Dashboard provides a user-friendly experience for tenants to monitor and analyze the status of their jobs. It serves as a graphical representation of the Jobico platform, offering insights into the dynamic execution of jobs, the current state of the system, and facilitating quick decision-making through its visually appealing display. The Dashboard enhances the overall user experience by providing a vivid and informative overview of the platform's activity.

# Job Definition

#### `id`

- **Description:** The "id" attribute represents the unique identifier for the job. It serves as a distinct reference to identify and manage the job within the Jobico platform.

- **Example:**

  ```yaml
  id: 12345
  ```

  In this example, "12345" is the unique identifier assigned to the job.

#### `tenant`

- **Description:** The "tenant" attribute represents the ID of the tenant associated with the job. It ensures that the job is attributed to a specific tenant within the multi-tenancy architecture of Jobico.

- **Example:**

  ```yaml
  tenant: 56789
  ```

  In this example, "56789" is the ID of the tenant associated with the job.

#### `queues`

- **Description:** The "queues" section describes the queues associated with the job. This section allows for future expansion where queue environments and capabilities can be defined.

  - `queues.id`: ID of the queue.
  - `queues.name`: Friendly name of the queue.

- **Example:**

  ```yaml
  queues:
    - id: 1
      name: high-priority-queue
    - id: 2
      name: default-queue
  ```

  In this example, two queues, "high-priority-queue" and "default-queue," are defined with their respective IDs.

#### `jobs`

- **Description:** The "jobs" section is where the events are defined and how they will be validated and processed.

  - `jobs.event`: An event definition.
  - `jobs.event.name`: Friendly name for the event.
  - `jobs.event.id`: ID for the event, used by the REST API and executors to determine the schema and WASM file.
  - `jobs.event.datatype`: Specifies the data type of the event. "0" represents JSON.

  - **`jobs.event.schema`: Schema file definition:**

    - `jobs.event.schema.id`: ID of the schema file.
    - `jobs.event.schema.name`: Name of the schema file.
    - `jobs.event.schema.schemaref`: Reference used to retrieve the file from the repository.

  - `jobs.event.supplierqueue`: Specifies the ID of the queue where this event will be published.
  - `jobs.event.runtime`: ID of the runtime that will process this event.
  - `jobs.event.result`: Specifies how the result of the execution will be treated (Under Construction).

- **Example:**

  ```yaml
  jobs:
    - event:
        name: user-registration
        id: 6789
        datatype: 0
        schema:
          id: 9876
          name: user-registration-schema
          schemaref: /schemas/user-registration-schema.json
        supplierqueue: 1
        runtime: 1
        result: under-construction
  ```

  In this example, a job is defined for processing "user-registration" events with the associated schema and runtime details.

#### `runtimes`

- **Description:** The "runtimes" section specifies the runtimes available to process the events.

  - `runtimes.id`: ID of the runtime, used to reference a specific runtime.
  - `runtimes.name`: Friendly name.
  - `runtimes.moduleref`: Reference used to retrieve the file from the repository.
  - `runtimes.mainfuncname`: Not used at the moment.
  - `runtimes.type`: "0" represents WASM as the runtime type.

- **Example:**

  ```yaml
  runtimes:
    - id: 1
      name: wasm-runtime
      moduleref: /runtimes/wasm-runtime.wasm
      mainfuncname: main
      type: 0
  ```

  In this example, a runtime named "wasm-runtime" is defined with the associated WASM file and runtime type.

These attributes collectively form a comprehensive YAML file, capturing the essential details for defining and deploying jobs within the Jobico platform. If you have additional attributes or specific details you'd like to cover, feel free to provide them, and I'll be happy to assist further.

### Example
  ```yaml
name: test
id: test
tenant: m1 
queues:
  - id: queue
    name: queue
jobs:
  - event:
      name: an event
      id: ev1
      datatype: 0
      schema:
        id: schema
        name: the schema
        schemaref: schema.json
      supplierqueue: queue
      runtime: runtime1
    result:
      ok:
        name: ev1_ok
        id: ev1_ok
        datatype: 0
        schema:
          id: sche1
          name: sche1
          schemaref: schema.json
        supplierqueue: queue1
        runtime: runtime1
      error:
        name: ev1_err
        id: ev1_err
        datatype: 0
        schema:
          id: sche1
          name: sche1
          schemaref: schema.json
        supplierqueue: queue1
        runtime: runtime1

runtimes:
  - id: runtime1
    name: greet.wasm
    moduleref: greet.wasm
    mainfuncname: event
    type: 0

  ```

## Jobicolet

### What is a Jobicolet?

A **Jobicolet** is a specialized WebAssembly (WASM) program designed to process an event and generate a result within the Jobico platform. It represents the executable logic that is dynamically loaded and executed by the Job Executors when handling specific events. The term "Jobicolet" is coined by combining "Job" and "Wasm," emphasizing its role in executing jobs written in any WASM-supported programming language.

### Key Characteristics:

1. **WASM Execution:**
   - A Jobicolet is implemented as a WebAssembly module, allowing it to be written in any programming language that compiles to WebAssembly. This flexibility empowers users to express their event processing logic in a language of their choice.

2. **Event Processing:**
   - The primary function of a Jobicolet is to process events. It takes as input the event data, performs the specified logic defined within the WASM module, and produces a result based on the defined processing rules.

3. **Result Generation:**
   - Upon processing an event, a Jobicolet generates a result. The nature of the result depends on the specific logic implemented in the WASM module. It could be a computation outcome, a transformed dataset, or any other relevant output.

4. **Language Agnostic:**
   - Jobicolets are language-agnostic in the sense that they can be written in any programming language that supports compilation to WebAssembly. This feature provides developers with the freedom to choose a language that aligns with their expertise and the requirements of their event processing tasks.

### Workflow:

1. **Implementation:**
   - Developers implement a Jobicolet by writing the event processing logic in a programming language that compiles to WebAssembly. The code is encapsulated within a WebAssembly module.

2. **Compilation:**
   - The source code of the Jobicolet is then compiled to WebAssembly bytecode, creating a binary module that can be executed on any WebAssembly runtime.

3. **Deployment:**
   - The compiled Jobicolet is deployed within the Jobico platform, and its metadata, such as the module reference, is registered in the Job Repository.

4. **Execution:**
   - When an event occurs that triggers the associated job, the Job Executors retrieve the corresponding Jobicolet from the Job Repository and execute it in the designated runtime environment.

5. **Result Handling:**
   - The executed Jobicolet produces a result, which is then handled according to the specified result processing rules defined in the job configuration.

### Benefits:

- **Flexibility:**
  - The language-agnostic nature of Jobicolets provides developers with flexibility, allowing them to choose the most suitable programming language for expressing their event processing logic.

- **Scalability:**
  - As Jobicolets are executed within the scalable and isolated environment of Job Executors, the platform can efficiently scale to handle a large number of concurrent event processing tasks.

- **Interoperability:**
  - Jobicolets can interact with other components within the Jobico platform, facilitating seamless integration with queues, event definitions, and runtime environments.

A Jobicolet, at its core, represents the embodiment of programmable and scalable event processing within the Jobico platform, offering developers the freedom to innovate using the power of WebAssembly.

## Getting Started

### Rust
### Tinygo

# Tools

## Command Line

## Jobico Command Line Tool

### Overview:

The **Jobico Command Line Tool** is a powerful management interface designed to facilitate the deployment, rollback, or redeployment of jobs within the Jobico platform. It offers a range of commands for uploading WebAssembly (WASM) and schema files, as well as streaming information from the Executions Recorder. This tool is an indispensable component for administrators and tenants alike, providing a streamlined and efficient way to interact with the platform.

### Key Features:

1. **Deployment Commands:**
   - **Deploy:**
     - The `deploy` command is used to deploy a job definition to the Jobico platform. It includes the necessary parameters, such as the name of the job, the associated WASM and schema files, and any additional configuration.

     ```bash
     jobico deploy my-job-definition
     ```

   - **Rollback:**
     - The `rollback` command allows for the rollback of a deployed job to a previous state. It's a useful feature for reverting to a stable configuration in case of issues.

     ```bash
     jobico rollback my-job-definition --version 1
     ```

   - **Redeploy:**
     - The `redeploy` command facilitates the redeployment of a job, updating its configuration or associated files without disrupting the ongoing execution.

     ```bash
     jobico redeploy my-job-definition --config new-config.yaml
     ```

2. **File Upload Commands:**
   - **Upload WASM:**
     - The `upload-wasm` command enables the upload of a WebAssembly file to the Job Repository. This file can then be referenced by Jobicolets during deployment.

     ```bash
     jobico upload-wasm my-job-logic.wasm
     ```

   - **Upload Schema:**
     - The `upload-schema` command allows the upload of JSON schema files to the Job Repository. These files define the structure of events processed by the platform.

     ```bash
     jobico upload-schema event-schema.json
     ```

3. **Streaming Information:**
   - **Stream from Recorder:**
     - The `stream-from-recorder` command allows users to stream information from the Executions Recorder. This feature is valuable for real-time monitoring and analysis of job executions.

     ```bash
     jobico stream-from-recorder my-job-definition
     ```

### Example Workflows:

#### Deploying a Job:

```bash
jobico deploy my-job-definition --config job-config.yaml --wasm my-job-logic.wasm --schema event-schema.json
```

This command deploys a job named "my-job-definition" with the specified configuration, WebAssembly logic, and event schema.

#### Uploading a WASM File:

```bash
jobico upload-wasm my-job-logic-v2.wasm
```

This command uploads a new version of the WebAssembly logic file to the Job Repository.

#### Streaming Information from Recorder:

```bash
jobico stream-from-recorder my-job-definition --logs
```

This command streams log information from the Executions Recorder for the specified job.

### Benefits:

- **Simplified Management:**
  - The Command Line Tool simplifies job management tasks, providing a command-line interface for deploying, updating, and monitoring jobs within the Jobico platform.

- **Efficient Deployment:**
  - With deployment, rollback, and redeployment commands, administrators can efficiently manage the lifecycle of jobs, ensuring flexibility and adaptability.

- **Real-time Monitoring:**
  - The streaming capability from the Executions Recorder allows users to monitor job executions in real-time, aiding in debugging and performance analysis.

The Jobico Command Line Tool is an essential companion for users interacting with the Jobico platform, providing a versatile set of commands to streamline job management and facilitate efficient operation within the platform.

## Dashboard - Terminal GUI

### Overview:

The **Jobico Dashboard** is a terminal-based graphical user interface (GUI) designed to offer an interactive and visual representation of the Jobico platform. This GUI allows users to seamlessly visualize deployed jobs, explore files in the repository, and stream real-time results produced by executed jobs, all within the convenience of the terminal.

### Key Features:

1. **Visualizing Deployed Jobs:**
   - The Dashboard GUI presents a visual overview of deployed jobs, displaying relevant details such as job names, configurations, and status indicators. Users can easily navigate and interact with job-related information.

2. **Browsing Repository Files:**
   - Users can explore files stored in the Job Repository through an intuitive graphical interface. This includes the ability to inspect WebAssembly (WASM) files, JSON schema definitions, and other artifacts crucial for job execution.

3. **Streaming Job Results:**
   - The Dashboard supports real-time streaming of results produced by executed jobs. The GUI provides a dynamic display of outcomes, offering users immediate visibility into the status and performance of their jobs.

### Example Dashboard Commands:

#### Launching the Dashboard:

```bash
jobico dashboard
```

Executing this command launches the Dashboard GUI, initiating an interactive environment for users to visually explore deployed jobs and related information.

### Benefits:

- **Intuitive Visual Interface:**
  - The Dashboard GUI provides an intuitive and graphical representation of key platform components, enhancing user experience and accessibility.

- **Efficient Navigation:**
  - Users can efficiently navigate through deployed jobs and repository files, leveraging the visual cues and interactive features offered by the graphical interface.

- **Real-time Visualization:**
  - Real-time streaming of job results within the GUI enables users to monitor and analyze outcomes promptly, facilitating quick decision-making.

The Jobico Dashboard as a terminal GUI elevates the user experience by offering a visually rich and interactive interface for exploring and managing jobs within the Jobico platform. Its graphical features provide an efficient and streamlined approach to monitoring, navigation, and real-time visualization of critical information.


# Goico: The Jobico Framework

## Overview:

**Goico** is a specialized framework meticulously crafted to support the development and evolution of Jobico, the innovative job execution platform. Tailored to meet the unique requirements of Jobico, Goico offers a versatile set of features and capabilities, empowering developers to create services, expose REST or gRPC APIs, and build headless worker services seamlessly.

## Key Features:

### 1. Service Creation and API Exposure:

Goico simplifies the development of microservices within the Jobico ecosystem. Developers can effortlessly create services that expose REST or gRPC APIs, fostering a modular and scalable architecture. Whether crafting interactive interfaces or building headless worker services, Goico provides the essential foundation for diverse service types.

### 2. WASM Runtime Based on WAZERO:

A core strength of Goico lies in its WebAssembly (WASM) runtime, built on the robust foundation of WAZERO. This runtime facilitates the execution of custom logic written in any WASM-supported programming language. This empowers developers to implement dynamic and language-agnostic Jobicolets, the key components responsible for processing events and generating results.

### 3. Key/Value Embedded Database:

Goico integrates a powerful embedded database based on bbolt, offering a key/value store for efficient data management. This embedded database serves as the backbone for storing critical information, supporting the reliable and fast retrieval of data essential for the operation of Jobico.

### 4. Streaming Capabilities for Database Updates:

Goico goes beyond basic database functionality by providing advanced streaming capabilities for database updates. This feature enables real-time monitoring and reaction to changes within the embedded database, facilitating dynamic adjustments, and enhancing the responsiveness of Jobico to evolving requirements.

## Use Cases:

- **Microservices Development:**
  - Goico streamlines the creation of microservices, enabling developers to build modular components that contribute to the overall functionality of Jobico.

- **Language-Agnostic WASM Execution:**
  - With the WAZERO-based WASM runtime, Goico allows developers to implement Jobicolets in any programming language that compiles to WebAssembly, promoting flexibility and diversity in event processing.

- **Efficient Data Storage and Retrieval:**
  - The embedded database based on bbolt provides a reliable and performant key/value store, supporting the storage and retrieval of essential data within the Jobico framework.

- **Real-time Monitoring and Adaptation:**
  - Goico's streaming capabilities for database updates empower Jobico to react in real-time to changes, facilitating dynamic adjustments and ensuring responsiveness to evolving requirements.

## Conclusion:

Goico stands as a dedicated framework designed with the singular purpose of supporting the development and advancement of Jobico. Through its service creation capabilities, powerful WASM runtime, embedded database, and streaming functionalities, Goico provides the solid foundation upon which Jobico's innovative features and capabilities thrive. As Jobico evolves, Goico remains a reliable companion, empowering developers to navigate the complexities of job execution and event processing with ease and efficiency.

## Installation

### Docker

## Stack

Golang
Zerolog
Wazero
GRPC
Tview: https://github.com/rivo/tview



## Roadmap




### Acknowledgements

## Support and Contact

For questions, feedback, or assistance, reach out to us at [jobicowasm@gmail.com].
